# 受け入れ基準（Acceptance Criteria）

## 概要

Suptiaフロントエンド実装の受け入れ基準を定義します。各機能が要件を満たし、品質基準をクリアしていることを確認するためのテスト観点とチェックリストを提供します。

## 機能別受け入れ基準

### 1. ブランドアイデンティティとナビゲーション

#### 受け入れ条件

- [x] ヘッダーに「サプティア」＋「Suptia」ロゴが表示される
- [x] キャッチフレーズ「あなたに最も合うサプリを最も安い価格で。」が明確に表示される
- [x] ナビゲーションメニューが適切に機能する
- [x] 言語・通貨切替が正常に動作する

#### テスト観点

```typescript
// ヘッダーコンポーネントのテスト
describe('Header Component', () => {
  test('ロゴが正しく表示される', () => {
    // サプティア + Suptiaロゴの表示確認
    // ロゴクリック時のホームページ遷移確認
  });

  test('ナビゲーションメニューが機能する', () => {
    // 各メニュー項目のクリック動作確認
    // アクティブ状態の表示確認
  });

  test('言語・通貨切替が動作する', () => {
    // 言語切替時の表示変更確認
    // 通貨切替時の価格表示変更確認
  });
});
```

### 2. 検索機能とAIレコメンド

#### 受け入れ条件

- [x] ファーストビューに大型検索窓が中央配置される
- [x] AIレコメンド機能が適切に動作する
- [x] 検索結果が正確に表示される
- [x] レスポンシブデザインが適用される

#### テスト観点

```typescript
describe('Search Functionality', () => {
  test('検索窓が適切に表示される', () => {
    // 大型検索窓の表示確認
    // プレースホルダーテキストの確認
  });

  test('AIレコメンドが機能する', () => {
    // 入力に応じたレコメンド表示確認
    // レコメンド項目のクリック動作確認
  });

  test('検索結果が正確に表示される', () => {
    // 検索クエリに対する結果の正確性確認
    // 結果の並び順確認
  });
});
```

### 3. 診断システム

#### 受け入れ条件

- [x] 診断フォームが段階的に表示される
- [x] 総合スコアが正確に計算される
- [x] 4つの内訳スコア（エビデンス・安全・コスト・実用性）が表示される
- [x] 実効コスト/日が正確に計算される
- [x] 危険成分アラートが適切に表示される

#### テスト観点

```typescript
describe('Diagnosis System', () => {
  test('診断フォームが正常に動作する', () => {
    // 質問の段階的表示確認
    // フォームバリデーション確認
    // 回答の保存確認
  });

  test('スコア計算が正確である', () => {
    // 総合スコアの計算ロジック確認
    // 各内訳スコアの計算確認
    // 実効コスト計算の正確性確認
  });

  test('危険成分アラートが機能する', () => {
    // 危険成分検出時のアラート表示確認
    // アラートの重要度別表示確認
  });
});
```

### 4. 商品詳細ページ

#### 受け入れ条件

- [x] 成分一覧が配合量と共に表示される
- [x] 正規化価格比較が正確に表示される
- [x] 相互作用・禁忌情報が表示される
- [x] 研究要約・口コミ要約が表示される
- [x] 価格履歴グラフが表示される
- [x] お気に入り保存機能が動作する

#### テスト観点

```typescript
describe('Product Detail Page', () => {
  test('商品情報が正確に表示される', () => {
    // 成分一覧の表示確認
    // 配合量の正確性確認
    // 基本情報の表示確認
  });

  test('価格比較機能が正常に動作する', () => {
    // 正規化価格の計算確認
    // 複数販売者の価格比較確認
    // 価格履歴グラフの表示確認
  });

  test('安全性情報が適切に表示される', () => {
    // 相互作用情報の表示確認
    // 禁忌情報の表示確認
    // 安全性スコアの表示確認
  });
});
```

### 5. 成分ガイド

#### 受け入れ条件

- [x] カテゴリ別成分一覧が表示される
- [x] 目的別フィルタが機能する
- [x] 形状別・価格帯別フィルタが機能する
- [x] 成分詳細情報が表示される

#### テスト観点

```typescript
describe('Ingredient Guide', () => {
  test('カテゴリ表示が正常に動作する', () => {
    // ビタミン・ミネラル等のカテゴリ表示確認
    // カテゴリ切替時の表示更新確認
  });

  test('フィルタ機能が正常に動作する', () => {
    // 目的別フィルタの動作確認
    // 複数条件での絞り込み確認
    // フィルタリセット機能の確認
  });
});
```

### 6. 比較機能

#### 受け入れ条件

- [x] 複数商品の横並び比較が表示される
- [x] 比較項目が統一された形式で表示される
- [x] 商品の追加・削除が可能である
- [x] ソート・フィルタ機能が動作する

#### テスト観点

```typescript
describe('Comparison Feature', () => {
  test('比較テーブルが正常に表示される', () => {
    // 横並び比較の表示確認
    // 統一フォーマットでの表示確認
  });

  test('比較操作が正常に動作する', () => {
    // 商品追加・削除機能の確認
    // ソート機能の確認
    // フィルタ機能の確認
  });
});
```

### 7. マイページ機能

#### 受け入れ条件

- [x] お気に入り商品一覧が表示される
- [x] 診断履歴が表示される
- [x] 価格アラート設定が機能する
- [x] 有料会員特典が適切に表示される

#### テスト観点

```typescript
describe('My Page Features', () => {
  test('お気に入り管理が正常に動作する', () => {
    // お気に入り一覧の表示確認
    // 追加・削除機能の確認
    // カテゴリ別整理機能の確認
  });

  test('履歴機能が正常に動作する', () => {
    // 診断履歴の表示確認
    // 履歴詳細の表示確認
  });

  test('価格アラート機能が動作する', () => {
    // アラート設定の保存確認
    // 通知機能の動作確認
  });
});
```

## パフォーマンス受け入れ基準

### Core Web Vitals

#### 受け入れ条件

- [ ] LCP（Largest Contentful Paint）≤ 2.5秒
- [ ] FID（First Input Delay）≤ 100ms
- [ ] CLS（Cumulative Layout Shift）≤ 0.1

#### テスト観点

```typescript
describe('Performance Tests', () => {
  test('Core Web Vitalsが基準を満たす', () => {
    // Lighthouse CI での自動測定
    // 実デバイスでのパフォーマンス測定
    // 継続的な監視設定の確認
  });

  test('ページ読み込み速度が適切である', () => {
    // 初回読み込み時間の測定
    // キャッシュ効果の確認
    // 画像最適化の効果確認
  });
});
```

### バンドルサイズ

#### 受け入れ条件

- [ ] 初期バンドルサイズ ≤ 200KB（gzip圧縮後）
- [ ] 各ページの追加バンドル ≤ 100KB
- [ ] 未使用コードの除去が適切に行われている

## セキュリティ受け入れ基準

### コンテンツセキュリティ

#### 受け入れ条件

- [ ] CSP（Content Security Policy）が適切に設定されている
- [ ] XSS攻撃対策が実装されている
- [ ] コンテンツサニタイズが機能している
- [ ] 薬機法チェック済みコンテンツのみ表示される

#### テスト観点

```typescript
describe('Security Tests', () => {
  test('CSPが適切に設定されている', () => {
    // CSPヘッダーの確認
    // 外部リソース読み込み制限の確認
  });

  test('コンテンツサニタイズが機能する', () => {
    // 悪意のあるスクリプトの除去確認
    // HTMLタグの適切なエスケープ確認
  });

  test('薬機法コンプライアンスが確保されている', () => {
    // 違反表現の検出・除去確認
    // コンプライアンスチェック済みフラグの確認
  });
});
```

## アクセシビリティ受け入れ基準

### WCAG 2.1 AA準拠

#### 受け入れ条件

- [x] キーボードナビゲーションが完全に機能する
- [x] スクリーンリーダーで適切に読み上げられる
- [ ] カラーコントラスト比が4.5:1以上である
- [x] フォーカス管理が適切に行われている

#### テスト観点

```typescript
describe('Accessibility Tests', () => {
  test('キーボードナビゲーションが機能する', () => {
    // Tab キーでの順次移動確認
    // Enter/Space キーでの操作確認
    // Escape キーでのモーダル閉じる確認
  });

  test('スクリーンリーダー対応が適切である', () => {
    // aria-label の適切な設定確認
    // 見出し構造の論理的な階層確認
    // 代替テキストの適切な設定確認
  });

  test('カラーコントラストが基準を満たす', () => {
    // axe-core による自動チェック
    // 手動でのコントラスト比確認
  });
});
```

## 国際化受け入れ基準

### 多言語対応

#### 受け入れ条件

- [ ] 日本語・英語の切替が正常に動作する
- [ ] 通貨表示（円・ドル）の切替が機能する
- [ ] 日付・数値フォーマットが適切に表示される
- [ ] 文字化けが発生しない

#### テスト観点

```typescript
describe('Internationalization Tests', () => {
  test('言語切替が正常に動作する', () => {
    // UI要素の翻訳確認
    // 言語設定の永続化確認
  });

  test('通貨表示が適切である', () => {
    // 価格フォーマットの確認
    // 通貨記号の表示確認
  });
});
```

## ブラウザ互換性受け入れ基準

### サポート対象ブラウザ

#### 受け入れ条件

- [ ] Chrome（最新版 + 2バージョン前まで）
- [ ] Firefox（最新版 + 2バージョン前まで）
- [ ] Safari（最新版 + 2バージョン前まで）
- [ ] Edge（最新版 + 2バージョン前まで）

#### テスト観点

```typescript
describe('Browser Compatibility Tests', () => {
  test('各ブラウザで正常に動作する', () => {
    // 基本機能の動作確認
    // レイアウトの表示確認
    // JavaScript機能の動作確認
  });
});
```

## モバイル対応受け入れ基準

### レスポンシブデザイン

#### 受け入れ条件

- [x] スマートフォン（375px〜）で適切に表示される
- [x] タブレット（768px〜）で適切に表示される
- [x] デスクトップ（1024px〜）で適切に表示される
- [x] タッチ操作が適切に機能する

#### テスト観点

```typescript
describe('Mobile Responsiveness Tests', () => {
  test('各画面サイズで適切に表示される', () => {
    // ブレークポイントでの表示確認
    // 横向き・縦向きでの表示確認
  });

  test('タッチ操作が機能する', () => {
    // タップ・スワイプ操作の確認
    // タッチターゲットサイズの確認（44px以上）
  });
});
```

## 最終受け入れチェックリスト

### 機能要件

- [ ] 全ての要件が実装されている
- [ ] 各機能が仕様通りに動作する
- [ ] エラーハンドリングが適切に実装されている
- [ ] ユーザビリティが良好である

### 非機能要件

- [ ] パフォーマンス基準を満たしている
- [ ] セキュリティ要件を満たしている
- [ ] アクセシビリティ基準を満たしている
- [ ] ブラウザ互換性を満たしている

### 品質要件

- [ ] 単体テストのカバレッジが80%以上である
- [ ] 統合テストが全て成功している
- [ ] E2Eテストが全て成功している
- [ ] コードレビューが完了している

### デプロイ要件

- [ ] 本番環境での動作確認が完了している
- [ ] 監視・ログ設定が適切に行われている
- [ ] ロールバック手順が確立されている
- [ ] ドキュメントが整備されている

## 受け入れテスト実行手順

### 1. 自動テスト実行

```bash
# 単体テスト実行
npm run test

# 統合テスト実行
npm run test:integration

# E2Eテスト実行
npm run test:e2e

# パフォーマンステスト実行
npm run test:performance

# アクセシビリティテスト実行
npm run test:a11y
```

### 2. 手動テスト実行

- [ ] 各ブラウザでの動作確認
- [ ] 各デバイスでの表示確認
- [ ] ユーザーシナリオに沿った操作確認
- [ ] エラーケースの動作確認

### 3. 受け入れ判定

- [ ] 全ての自動テストが成功している
- [ ] 手動テストで問題が発見されていない
- [ ] パフォーマンス基準を満たしている
- [ ] セキュリティ要件を満たしている

## 受け入れ後の継続監視

### 監視項目

- [ ] Core Web Vitalsの継続監視
- [ ] エラー率の監視
- [ ] ユーザー行動の分析
- [ ] セキュリティインシデントの監視

### 改善サイクル

- [ ] 週次パフォーマンスレポートの確認
- [ ] 月次ユーザビリティ評価の実施
- [ ] 四半期セキュリティ監査の実施
- [ ] 年次アクセシビリティ監査の実施
